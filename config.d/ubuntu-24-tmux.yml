ubuntu-24-tmux:
  image: ubuntu:24.04
  #shell: /usr/bin/tmux
  shell: /bin/bash
  keep_alive_cmd: sleep infinity
  description: Ubuntu 24.04 with Tmux
  category: linux
  ports:
    - "2226:22"
  scripts:
    post_start:
      inline: |
        #!/bin/bash
        set -e
        echo "Installing Tmux and dependencies..."

        # Esegui i comandi all'interno del container
        docker exec "${CONTAINER_NAME}" bash -c '
          # Enable error handling and non-interactive mode
          set -e
          export DEBIAN_FRONTEND=noninteractive

          # Install apt-utils first to avoid debconf issues
          apt-get update -qq >/dev/null 2>&1
          apt-get install -y -qq apt-utils >/dev/null 2>&1
          if [ $? -eq 0 ]; then
            echo "âœ“ Installed apt-utils"
          else
            echo "âœ— Failed to install apt-utils"
            exit 1
          fi

          # Install other packages
          apt-get install -y -qq tmux git curl wget vim nano htop tree net-tools >/dev/null 2>&1
          if [ $? -eq 0 ]; then
            echo "âœ“ Installed packages"
          else
            echo "âœ— Failed to install packages"
            exit 1
          fi

          # Create tmux config
          cat > ~/.tmux.conf << "EOF_TMUX_CONFIG"
          # Set prefix to Ctrl-B (default)
          set -g prefix C-b

          # Basic settings
          set -g mouse on
          set -g history-limit 5000

          # Keybindings
          bind c new-window
          bind o select-pane -t :.+
          bind x kill-pane
          bind z resize-pane -Z
          bind d detach-client
          bind s new-session
          bind n next-window
          bind p previous-window
          bind : command-prompt
          bind q kill-server

          # Status bar
          set -g status-bg black
          set -g status-fg white
        EOF_TMUX_CONFIG

          if [ $? -eq 0 ]; then
            echo "âœ“ Created ~/.tmux.conf"
          else
            echo "âœ— Failed to create ~/.tmux.conf"
            exit 1
          fi
        '

        if [ $? -eq 0 ]; then
          echo "âœ“ Tmux installed and configured"
        else
          echo "âœ— Failed to install or configure Tmux"
          exit 1
        fi
  motd: |
    â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
    â•‘             Ubuntu 24.04 with Tmux                           â•‘
    â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    
    QUICK START:
      tmux                    - Launch Tmux
      tmux new-session -s name - New session
      tmux attach -t name     - Attach to session
    
    SHORTCUTS (Ctrl+B prefix):
      New Window:      Ctrl+B then c
      Split Horizontal: Ctrl+B then "
      Split Vertical:  Ctrl+B then %
      Next Pane:       Ctrl+B then o
      Close Pane:      Ctrl+B then x
      Maximize Pane:   Ctrl+B then z
      New Session:     Ctrl+B then s
      Next Window:     Ctrl+B then n
      Previous Window: Ctrl+B then p
      Command Mode:    Ctrl+B then :
      Detach:          Ctrl+B then d
      Kill Server:     Ctrl+B then q
    
    ðŸ“ Configuration:
      ~/.tmux.conf - Tmux configuration