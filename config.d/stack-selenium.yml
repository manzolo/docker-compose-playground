# Group metadata
group:
  name: "Selenium-Stack"
  description: "Selenium browser automation with Chrome, Firefox and Hub"
  category: testing
  containers:
    - selenium-chrome
    - selenium-firefox
    - selenium-hub

# Container configurations
images:
  selenium-chrome:
    category: testing
    description: Selenium Chrome - Browser Automation with Chrome
    image: selenium/standalone-chrome:latest
    keep_alive_cmd: /opt/bin/entry_point.sh
    shell: /bin/bash
    environment:
      SE_NODE_MAX_SESSIONS: "4"
      SE_START_VNC: "true"
      SE_VNC_NO_CNXN_ATTEMPTS: "3"
      SE_VNC_CONNECTION_DELAY: "5"
    ports:
      - "4444:4444"   # Selenium Server API
      - "7900:7900"   # VNC (live browser view)
    volumes:
      - type: named
        name: selenium_chrome_data
        path: /dev/shm

    motd: |
      â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
      â•‘         Selenium Standalone - Chrome Browser                â•‘
      â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

      ğŸŒ  Selenium API: http://localhost:4444
        Remote WebDriver URL: http://localhost:4444
        Status: http://localhost:4444/status

      ğŸ‘ï¸  VNC Viewer (Live Browser):
        Address: localhost:7900
        Port: 7900
        Password: secret

      ğŸ“Š  Quick Commands:
        # Check Selenium status:
        curl -s http://localhost:4444/status | jq .
        
        # Get session info:
        curl -s http://localhost:4444/sessions | jq .
        
        # Download VNC viewer for your OS:
        TigerVNC, RealVNC, or any VNC client

      ğŸ”§  Python Example:
        from selenium import webdriver
        from selenium.webdriver.common.by import By
        from selenium.webdriver.chrome.options import Options

        chrome_options = Options()
        driver = webdriver.Remote(
         command_executor='http://localhost:4444',
         options=chrome_options
        )
        
        driver.get('https://www.google.com')
        search_box = driver.find_element(By.NAME, 'q')
        search_box.send_keys('Selenium Docker')
        search_box.submit()
        
        driver.quit()

      ğŸ”§  Java Example:
        WebDriver driver = new RemoteWebDriver(
         new URL("http://localhost:4444"),
         new ChromeOptions()
        );
        
        driver.get("https://www.google.com");
        WebElement searchBox = driver.findElement(By.name("q"));
        searchBox.sendKeys("Selenium Docker");
        searchBox.submit();
        
        driver.quit();

      ğŸ”§  JavaScript (Node.js) Example:
        const { Builder } = require('selenium-webdriver');
        const chrome = require('selenium-webdriver/chrome');

        let driver = new Builder()
         .usingServer('http://localhost:4444')
         .forBrowser('chrome')
         .build();

        driver.get('https://www.google.com');
        driver.quit();

      ğŸ“  Important Paths:
        /dev/shm           # Shared memory for Chrome
        /opt/selenium      # Selenium files
        /var/log/supervisor # Logs

      ğŸ’¾  Persistence:
        Data in /dev/shm is temporary
        For persistent storage, mount additional volumes

      ğŸ¯  Learning Resources:
        â€¢ Selenium Docs: https://www.selenium.dev/documentation/
        â€¢ WebDriver API: https://www.w3.org/TR/webdriver/
        â€¢ Best Practices: https://www.selenium.dev/documentation/webdriver/

      ğŸš€  Common Use Cases:
        â€¢ Web application testing (E2E tests)
        â€¢ Web scraping
        â€¢ Screenshot capture
        â€¢ Performance testing
        â€¢ UI regression testing

      âš™ï¸  Configuration:
        SE_NODE_MAX_SESSIONS: 4 (parallel browsers)
        SE_START_VNC: enabled (watch tests run)
        Browser: Chrome (latest)

  selenium-firefox:
    category: testing
    description: Selenium Firefox - Browser Automation with Firefox
    image: selenium/standalone-firefox:latest
    keep_alive_cmd: /opt/bin/entry_point.sh
    shell: /bin/bash
    environment:
      SE_NODE_MAX_SESSIONS: "4"
      SE_START_VNC: "true"
      SE_VNC_NO_CNXN_ATTEMPTS: "3"
      SE_VNC_CONNECTION_DELAY: "5"
    ports:
      - "4445:4444"   # Selenium Server API (different port)
      - "7901:7900"   # VNC (different port)
    volumes:
      - type: named
        name: selenium_firefox_data
        path: /dev/shm

    motd: |
      â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
      â•‘       Selenium Standalone - Firefox Browser                 â•‘
      â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

      ğŸŒ  Selenium API: http://localhost:4445
        Remote WebDriver URL: http://localhost:4445
        Status: http://localhost:4445/status

      ğŸ‘ï¸  VNC Viewer (Live Browser):
        Address: localhost:7901
        Port: 7901
        Password: secret

      ğŸ“Š  Quick Commands:
        # Check Selenium status:
        curl -s http://localhost:4445/status | jq .
        
        # Get session info:
        curl -s http://localhost:4445/sessions | jq .

      ğŸ”§  Python Example:
        from selenium import webdriver
        from selenium.webdriver.firefox.options import Options

        firefox_options = Options()
        driver = webdriver.Remote(
         command_executor='http://localhost:4445',
         options=firefox_options
        )
        
        driver.get('https://www.google.com')
        driver.quit()

      ğŸ”§  Java Example:
        WebDriver driver = new RemoteWebDriver(
         new URL("http://localhost:4445"),
         new FirefoxOptions()
        );
        
        driver.get("https://www.google.com");
        driver.quit();

      ğŸ“  Important Paths:
        /dev/shm           # Shared memory for Firefox
        /opt/selenium      # Selenium files
        /var/log/supervisor # Logs

      ğŸ’¾  Persistence:
        Data in /dev/shm is temporary
        For persistent storage, mount additional volumes

      ğŸ¯  Browser Comparison:
        Chrome:
         â€¢ Faster, more stable
         â€¢ Better for automated testing
         â€¢ More resources
        
        Firefox:
         â€¢ More compatible
         â€¢ Open source
         â€¢ Lighter weight

      ğŸš€  Testing Strategy:
        â€¢ Use Chrome for speed (default)
        â€¢ Use Firefox for compatibility testing
        â€¢ Run both in CI/CD pipeline
        â€¢ Parallel execution with multiple instances

      âš™ï¸  Configuration:
        SE_NODE_MAX_SESSIONS: 4 (parallel browsers)
        SE_START_VNC: enabled (watch tests run)
        Browser: Firefox (latest)

  selenium-hub:
    category: testing
    description: Selenium Hub - Distribute Tests Across Multiple Nodes
    image: selenium/hub:latest
    keep_alive_cmd: /opt/bin/entry_point.sh
    shell: /bin/bash
    ports:
      - "4446:4444"   # Hub API (mapped to 4446 on host)

    motd: |
      â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
      â•‘         Selenium Hub - Grid Management                      â•‘
      â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

      ğŸŒ  Hub Console: http://localhost:4446
        Grid API: http://localhost:4446
        Status: http://localhost:4446/status

      ğŸ“Š  Available Nodes:
        â€¢ Chrome:  http://localhost:4444
        â€¢ Firefox: http://localhost:4445

      ğŸ”§  Architecture:
        Hub (central server) â† Nodes (Chrome, Firefox, etc)
        
        â€¢ Receives test requests from clients
        â€¢ Routes to appropriate browser nodes
        â€¢ Balances load across nodes
        â€¢ Manages browser sessions

      ğŸ’¡  Use Cases:
        â€¢ Distributed testing across multiple machines
        â€¢ Cross-browser testing at scale
        â€¢ Parallel test execution
        â€¢ CI/CD pipeline integration

      ğŸš€  Next Steps:
        1. Connect nodes to hub:
         docker run --network host \
         -e SE_HUB_HOST=localhost \
         -e SE_HUB_PORT=4446 \
         selenium/node-chrome

        2. Send tests to hub from client:
         driver = webdriver.Remote(
         'http://localhost:4446'
         )
        
        3. Monitor in console:
         http://localhost:4446

      âš™ï¸  Configuration:
        Hub listens on port 4446
        Connect nodes via: http://hub:4446
        Load balancing: Automatic
